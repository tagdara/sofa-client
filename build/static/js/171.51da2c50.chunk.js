(this["webpackJsonpsofa-client"]=this["webpackJsonpsofa-client"]||[]).push([[171],{177:function(e,i,t){"use strict";t.r(i),t.d(i,"default",(function(){return C}));var n=t(11),a=t(6),r=t(0),c=t.n(r),l=t(38),o=t(283),d=t(335),s=t(25),m=t(338),u=t(109),v=t(333),f=t.n(v),p=t(341),b=t.n(p),w=t(342),h=t.n(w),x=t(144),E=t(26),O=t(37),y=t(357),g=t(327),k=t(111),P=Object(l.a)({flex:{display:"flex"},wideSelect:{width:"100%"}}),j=Object(o.a)((function(e){return{input:{minWidth:"100px",borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4,borderColor:"#80bdff",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}}}))(k.a);function C(e){var i=P(),l=N(U(e.item.command),e.item.command),o=Object(r.useState)(z(l)),v=Object(a.a)(o,2),p=v[0],w=v[1],k=N(e.item.controller,e.item.command),C=function(){if(void 0===e.device)return;if(e.device.hasOwnProperty("capabilities"))for(var i=0;i<e.device.capabilities.length;i++)if(e.device.capabilities[i].interface.split(".")[1]===e.item.controller){if(void 0===e.item.instance&&void 0===e.device.capabilities[i].interface.instance)return e.device.capabilities[i];if(e.item.hasOwnProperty("instance")&&e.device.capabilities[i].hasOwnProperty("instance")&&e.item.instance===e.device.capabilities[i].instance.split(".")[1])return e.device.capabilities[i]}return void console.log("failed get interface",e.item.controller,e.item.instance,e.device)}();function S(e){return c.a.createElement(u.a,{value:"failed"+e})}function z(e){return void 0===e?null:c.a.lazy((function(){try{return t(388)("./"+e).catch((function(){return{default:function(){return S(e)}}}))}catch(i){return S(e)}}))}function N(i,t){if(void 0!==i&&void 0!==t&&e.directives.hasOwnProperty(i)&&e.directives[i].hasOwnProperty(t)){var n=e.directives[i][t];for(var a in n)return a}}function D(i){var t=e.device;i&&(t=i);var n=[];if(t.hasOwnProperty("capabilities"))for(var a=0;a<t.capabilities.length;a++){var r=t.capabilities[a].interface.split(".")[1];"ModeController"===r?n=n.concat("SetMode."+t.capabilities[a].instance.split(".")[1]):e.directives.hasOwnProperty(r)&&(n=n.concat(Object.keys(e.directives[r])))}return n}function F(e){return c.a.createElement(u.a,{value:e})}function I(i,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0);"TurnOn"===a&&(r="ON"),"TurnOff"===a&&(r="OFF"),e.save(e.index,Object(n.a)({},e.item,{controller:t,command:a,instance:c,value:r}))}function U(i){if(void 0!==e.device&&void 0!==i)for(var t in e.directives){if(e.directives[t].hasOwnProperty(i))return t;if(e.item.hasOwnProperty("instance")&&void 0!==e.item.instance&&e.directives[t].hasOwnProperty(e.item.command))return t}}return c.a.createElement(E.default,{nolist:!0,elevation:0,wide:!0,xs:12},c.a.createElement(x.default,{device:e.device,index:e.index,selectDevice:function(i){var t;console.log("selected new device",i),w(z(N(i.capabilities[0].interface,D(i.capabilities[0].interface)[0]))),t=Object(n.a)({},e.item,{instance:i.capabilities[0].instance,name:i.friendlyName,endpointId:i.endpointId,controller:i.capabilities[0],command:D(i.capabilities[0].interface)[0],value:void 0}),e.save(e.index,t)},wide:e.wide,remove:e.remove,reorder:e.reorder,moveUp:e.moveUp,moveDown:e.moveDown,delete:e.delete}),void 0!==e.device&&c.a.createElement(O.a,{item:!0,xs:e.wide?12:4,className:i.flex},c.a.createElement(s.a,null,c.a.createElement(g.a,{className:i.wideSelect,value:void 0!==e.item.command?e.item.hasOwnProperty("instance")&&void 0!==e.item.instance?e.item.command+"."+e.item.instance:e.item.command:"",onChange:function(i){return function(i){var t=i;w(z(N(U(t.split(".")[0]),t.split(".")[0]))),e.save(e.index,Object(n.a)({},e.item,{controller:U(t.split(".")[0]),command:t.split(".")[0],instance:t.split(".")[1],value:void 0}))}(i.target.value)},input:c.a.createElement(j,{name:"command",id:"command-select"})},D().map((function(i){return c.a.createElement(y.a,{key:e.device.endpointId+i,value:i},i)}))))),void 0!==e.device&&c.a.createElement(O.a,{item:!0,xs:e.wide?12:4,className:i.flex},c.a.createElement(s.a,null,C?function(i){if(void 0!==p){if(null===p)return null;var t=p;return c.a.createElement(r.Suspense,{key:i,fallback:F()},c.a.createElement(t,{item:e.item,interface:C,device:e.device,instance:e.item.instance,directive:I}))}return c.a.createElement(u.a,{value:"Loading..."})}(k):null)),!e.wide&&c.a.createElement(c.a.Fragment,null,e.remove&&c.a.createElement(m.a,null,c.a.createElement(d.a,{size:"small",onClick:function(){return e.delete(e.index)}},c.a.createElement(f.a,null))),e.reorder&&c.a.createElement(m.a,null,e.index>0&&c.a.createElement(d.a,{size:"small",onClick:function(){return e.moveUp(e.index)}},c.a.createElement(b.a,null)),c.a.createElement(d.a,{size:"small",onClick:function(){return e.moveDown(e.index)}},c.a.createElement(h.a,null)))))}}}]);
//# sourceMappingURL=171.51da2c50.chunk.js.map