{"version":3,"file":"sockette.js","sources":["../src/index.js"],"sourcesContent":["function noop() {}\n\nexport default function (url, opts) {\n\topts = opts || {};\n\n\tlet k, ws, $={};\n\tlet ms=opts.timeout || 1e3, num=0, max=opts.maxAttempts || Infinity;\n\n\tfor (k in opts) {\n\t\t(typeof opts[k] === 'function') && ($[k]=opts[k]);\n\t}\n\n\t$.onclose = e => {\n\t\t(e.code !== 1e3 && e.code !== 1005) && $.reconnect(e);\n\t\t(opts.onclose || noop)(e);\n\t};\n\n\t$.onerror = e => {\n\t\t(e && e.code==='ECONNREFUSED') ? $.reconnect(e) : (opts.onerror || noop)(e);\n\t};\n\n\t$.open = () => {\n\t\tws = new WebSocket(url, opts.protocols);\n\t\tfor (k in $) ws[k] = $[k];\n\t\treturn ws;\n\t};\n\n\t$.reconnect = e => {\n\t\t(++num < max) && setTimeout(_ => {\n\t\t\t($.onreconnect || noop)(e);\n\t\t\t$.open();\n\t\t}, ms);\n\t};\n\n\t$.json = x => {\n\t\tws.send(JSON.stringify(x));\n\t};\n\n\treturn $.open();\n}\n"],"names":["noop","url","opts","let","k","ws","$","ms","timeout","num","max","maxAttempts","Infinity","onclose","e","code","reconnect","onerror","open","WebSocket","protocols","setTimeout","_","onreconnect","json","x","send","JSON","stringify"],"mappings":"AAAA,SAASA,oBAET,SAAyBC,EAAKC,GAG7BC,IAAIC,EAAGC,EAAIC,KACPC,GAHJL,EAAOA,OAGKM,SAAW,IAAKC,EAAI,EAAGC,EAAIR,EAAKS,aAAeC,SAE3D,IAAKR,KAAKF,EACW,mBAAZA,EAAKE,KAAuBE,EAAEF,GAAGF,EAAKE,IA6B/C,OA1BAE,EAAEO,iBAAUC,GACC,MAAXA,EAAEC,MAA2B,OAAXD,EAAEC,MAAkBT,EAAEU,UAAUF,IAClDZ,EAAKW,SAAWb,GAAMc,IAGxBR,EAAEW,iBAAUH,GACVA,GAAc,iBAATA,EAAEC,KAAyBT,EAAEU,UAAUF,IAAMZ,EAAKe,SAAWjB,GAAMc,IAG1ER,EAAEY,gBAED,IAAKd,KADLC,EAAK,IAAIc,UAAUlB,EAAKC,EAAKkB,WACnBd,EAAGD,EAAGD,GAAKE,EAAEF,GACvB,OAAOC,GAGRC,EAAEU,mBAAYF,KACVL,EAAMC,GAAQW,oBAAWC,IAC1BhB,EAAEiB,aAAevB,GAAMc,GACxBR,EAAEY,QACAX,IAGJD,EAAEkB,cAAOC,GACRpB,EAAGqB,KAAKC,KAAKC,UAAUH,KAGjBnB,EAAEY"}