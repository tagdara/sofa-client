(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[219],{

/***/ "./src/old/dataContext.js":
/*!********************************!*\
  !*** ./src/old/dataContext.js ***!
  \********************************/
/*! exports provided: DataProvider, DataContext, withSofaTheme, realwithThemeChange, withThemeChange, withData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataProvider\", function() { return DataProvider; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataContext\", function() { return DataContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"withSofaTheme\", function() { return withSofaTheme; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"realwithThemeChange\", function() { return realwithThemeChange; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"withThemeChange\", function() { return withThemeChange; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"withData\", function() { return withData; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sockette_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sockette-component */ \"./node_modules/sockette-component/dist/sockette-component.es.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nvar Sockette = Object(sockette_component__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n  Component: react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"],\n  createElement: react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"]\n});\nvar DataProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DataProvider, _Component);\n\n  function DataProvider(props) {\n    var _this;\n\n    _classCallCheck(this, DataProvider);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DataProvider).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"uuidv4\", function () {\n      return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (c) {\n        return (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onOpen\", function (ev) {\n      _this.setState({\n        websocketStatus: \"connected\"\n      });\n\n      console.log(\"Websocket connected.\");\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onMessage\", function (ev) {\n      var jsondata = JSON.parse(ev.data); //console.log(\"> Received:\", jsondata);\n\n      if (jsondata.hasOwnProperty('event')) {\n        var devState = _this.state.deviceState;\n\n        for (var dev in _this.state.deviceState) {\n          if (_this.state.deviceState[dev].event.endpoint.endpointId == jsondata.event.endpoint.endpointId) {\n            //console.log('Match',dev,this.state.deviceState[dev],jsondata.event.endpoint.endpointId)\n            if ((jsondata.event.header.name = \"ChangeReport\") && jsondata.payload.hasOwnProperty('change')) {\n              //console.log('payload',jsondata.payload)\n              for (var j = 0; j < jsondata.payload.change.properties.length; j++) {\n                jsondata.context.properties.push(jsondata.payload.change.properties[j]);\n              }\n\n              jsondata.payload = {};\n              jsondata.event.header.name = \"StateReport\"; //console.log('Props:',jsondata.context.properties)\n            }\n\n            devState[dev] = jsondata;\n          }\n        }\n\n        _this.setState({\n          deviceState: devState\n        });\n      } else {\n        _this.setState({\n          rawUpdate: JSON.parse(ev.data)\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onReconnect\", function (ev) {\n      console.log(\"> Reconnecting...\", ev);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"sendMessage\", function (ev) {\n      // WebSocket available in state!\n      console.log('Sending', ev);\n\n      _this.state.socket.send(ev);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"sendAlexaCommand\", function (deviceName, endpointId, controller, command, val) {\n      // value is optional for some alexa commands.  The original sofa2 implementation tried to take a string value and then map it to \n      // a value name, but underestimated the requirement for some commands to pass multiple values and needs to be adjusted.\n      if (endpointId == '') {\n        console.log('No endpoint ID was provided for ', deviceName, controller, command, val);\n        endpointId = _this.deviceByName(deviceName).endpointId;\n      }\n\n      var header = {\n        \"name\": command,\n        \"namespace\": \"Alexa.\" + controller,\n        \"payloadVersion\": \"3\",\n        \"messageId\": _this.uuidv4(),\n        \"correlationToken\": _this.uuidv4()\n      };\n      var endpoint = {\n        \"endpointId\": endpointId,\n        \"cookie\": {},\n        \"scope\": {\n          \"type\": \"BearerToken\",\n          \"token\": \"access-token-from-skill\"\n        }\n      };\n\n      if (_this.state.controllers[controller][command]) {\n        var payload = JSON.parse(JSON.stringify(_this.state.controllers[controller][command]));\n      } else {\n        var payload = {};\n      }\n\n      for (var prop in payload) {\n        if (payload[prop] == 'value') {\n          payload[prop] = val;\n          break;\n        }\n      }\n\n      var data = {\n        \"directive\": {\n          \"header\": header,\n          \"endpoint\": endpoint,\n          \"payload\": payload\n        }\n      };\n      console.log('Sending alexa command:', data); //this.postAlexaCommand(data)\n\n      fetch('/directive', {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json, text/plain, */*',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(function (res) {\n        return console.log('Alexa command response:', res);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"mergeState\", function (dev, change) {\n      if (dev !== undefined && change !== undefined) {\n        var devstate = _objectSpread({}, _this.state.deviceState);\n\n        devstate[dev] = change;\n\n        _this.setState({\n          deviceState: devstate\n        });\n\n        return true;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"mergeStates\", function (devs) {\n      var devstate = _objectSpread({}, _this.state.deviceState, devs);\n\n      _this.setState({\n        deviceState: devstate\n      }, function () {\n        return console.log('Merge state done', Object.keys(devs).length);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"updateDevice\", function (dev) {\n      if (!_this.pendingDevs.includes(dev)) {\n        //var prestate={...this.state.deviceState}\n        //console.log('update prestate',dev,prestate)\n        _this.pendingDevs.push(dev); //prestate[dev]={}\n        //this.setState({deviceState:prestate})\n\n\n        fetch('/data/devices/' + dev + '?stateReport').then(function (result) {\n          return result.json();\n        }).then(function (data) {\n          return _this.mergeState(dev, data);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"updateMultipleDevices\", function (devs) {\n      console.log('getting updates for multiple devices', devs.length);\n      fetch('/deviceState', {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json, text/plain, */*',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(devs)\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        return _this.mergeStates(res);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"updateDeviceList\", function (devs) {\n      console.log('updating devices', devs);\n      var udl = [];\n\n      for (var i = 0; i < devs.length; i++) {\n        udl.push(devs[i].friendlyName);\n      }\n\n      _this.setState({\n        devices: devs\n      }, function () {\n        return _this.updateMultipleDevices(udl);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"devicesByCategory\", function (category) {\n      if (!category) {\n        category = 'ALL';\n      }\n\n      var categoryDevices = [];\n\n      for (var i = 0; i < _this.state.devices.length; i++) {\n        if (_this.state.devices[i].displayCategories.includes(category) || category == 'ALL') {\n          categoryDevices.push(_this.state.devices[i]);\n        }\n      }\n\n      categoryDevices.sort(function (a, b) {\n        var x = a['friendlyName'].toLowerCase(),\n            y = b['friendlyName'].toLowerCase();\n        return x < y ? -1 : x > y ? 1 : 0;\n      });\n      console.log('cat devs for', category, categoryDevices);\n      return categoryDevices;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"deviceByName\", function (devname) {\n      var fn = [];\n\n      for (var i = 0; i < _this.state.devices.length; i++) {\n        if (_this.state.devices[i]['friendlyName'] == devname) {\n          return _this.state.devices[i];\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"deviceByEndpointId\", function (endpointId) {\n      var fn = [];\n\n      for (var i = 0; i < _this.state.devices.length; i++) {\n        if (_this.state.devices[i]['endpointId'] == endpointId) {\n          return _this.state.devices[i];\n        }\n      }\n\n      console.log('Did not find device named', endpointId, _this.state.devices.length);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"propertiesFromDevices\", function (devs) {\n      var devstate = {};\n      var nostate = [];\n\n      if (devs == null) {\n        return devstate;\n      }\n\n      if (!Array.isArray(devs)) {\n        devs = [devs];\n      }\n\n      for (var i = 0; i < devs.length; i++) {\n        devstate[devs[i].friendlyName] = {};\n\n        if (_this.state.deviceState.hasOwnProperty(devs[i].friendlyName)) {\n          if (_this.state.deviceState[devs[i].friendlyName].hasOwnProperty('context')) {\n            for (var j = 0; j < _this.state.deviceState[devs[i].friendlyName].context.properties.length; j++) {\n              devstate[devs[i].friendlyName][_this.state.deviceState[devs[i].friendlyName].context.properties[j].name] = _this.state.deviceState[devs[i].friendlyName].context.properties[j].value;\n            }\n          }\n        } else if (!_this.pendingDevs.includes(devs[i].friendlyName)) {\n          _this.pendingDevs.push(devs[i].friendlyName);\n\n          nostate.push(devs[i].friendlyName);\n        }\n      }\n\n      if (nostate.length > 0) {\n        _this.updateMultipleDevices(nostate);\n      }\n\n      return devstate;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"setColorScheme\", function (scheme) {\n      console.log('set color scheme', scheme);\n      console.log('this', _assertThisInitialized(_assertThisInitialized(_this)));\n\n      _this.setState({\n        colorScheme: scheme\n      });\n    });\n\n    _this.state = {\n      devices: [],\n      deviceState: {},\n      controllers: {},\n      virtualDevices: {},\n      server: \"wss://\" + window.location.hostname + \"/ws\",\n      socket: null,\n      websocketStatus: 'init',\n      colorScheme: ''\n    };\n    _this.pendingDevs = [];\n    _this.deviceByName = _this.deviceByName.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.devicesByCategory = _this.devicesByCategory.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(DataProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      window.addEventListener('resize', this.handleWindowSizeChange);\n      console.log('Fetching device info');\n      fetch('/deviceList').then(function (result) {\n        return result.json();\n      }).then(function (data) {\n        return _this2.updateDeviceList(data);\n      }); //.then(this.setState({devices: data})\n\n      fetch('/controllercommands').then(function (result) {\n        return result.json();\n      }).then(function (result) {\n        return _this2.setState({\n          controllers: result\n        });\n      });\n      fetch('/list/logic/virtualDevices').then(function (result) {\n        return result.json();\n      }).then(function (result) {\n        return _this2.setState({\n          virtualDevices: result\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var children = this.props.children;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataContext.Provider, {\n        value: {\n          state: this.state,\n          devices: this.state.devices,\n          deviceState: this.state.deviceState,\n          virtualDevices: this.state.virtualDevices,\n          websocketStatus: this.state.websocketStatus,\n          controllers: this.state.controllers,\n          sendAlexaCommand: this.sendAlexaCommand,\n          deviceByName: this.deviceByName,\n          devicesByCategory: this.devicesByCategory,\n          propertiesFromDevices: this.propertiesFromDevices,\n          deviceByEndpointId: this.deviceByEndpointId,\n          colorScheme: this.state.colorScheme,\n          setColorScheme: this.setColorScheme\n        }\n      }, children, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Sockette, {\n        url: this.state.server,\n        getSocket: function getSocket(socket) {\n          _this3.setState({\n            socket: socket\n          });\n        },\n        maxAttempts: 25,\n        onopen: this.onOpen,\n        onmessage: this.onMessage,\n        onreconnect: this.onReconnect\n      }));\n    }\n  }]);\n\n  return DataProvider;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\nvar DataContext = react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext(DataProvider);\nfunction withSofaTheme(Component) {\n  return function DataComponent(props) {\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataContext.Consumer, null, function (_ref) {\n      var colorScheme = _ref.colorScheme;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n        colorScheme: colorScheme\n      }));\n    });\n  };\n}\nfunction realwithThemeChange(Component) {\n  return function DataComponent(props) {\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataContext.Consumer, null, function (_ref2) {\n      var setColorScheme = _ref2.setColorScheme,\n          colorScheme = _ref2.colorScheme;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n        setColorScheme: setColorScheme,\n        colorScheme: colorScheme\n      }));\n    });\n  };\n}\nfunction withThemeChange(Component) {\n  return function DataComponent(props) {\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataContext.Consumer, null, function (context) {\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n        context: context,\n        setColorScheme: context.setColorScheme,\n        colorScheme: context.colorScheme\n      }));\n    });\n  };\n}\nfunction withData(Component) {\n  return function DataComponent(props) {\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DataContext.Consumer, null, function (_ref3) {\n      var controllers = _ref3.controllers,\n          virtualDevices = _ref3.virtualDevices,\n          deviceByEndpointId = _ref3.deviceByEndpointId,\n          devices = _ref3.devices,\n          deviceState = _ref3.deviceState,\n          websocketStatus = _ref3.websocketStatus,\n          deviceByName = _ref3.deviceByName,\n          devicesByCategory = _ref3.devicesByCategory,\n          propertiesFromDevices = _ref3.propertiesFromDevices,\n          sendAlexaCommand = _ref3.sendAlexaCommand;\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n        cat: websocketStatus,\n        deviceByEndpointId: deviceByEndpointId,\n        controllers: controllers,\n        virtualDevices: virtualDevices,\n        deviceByName: deviceByName,\n        deviceProperties: propertiesFromDevices(devicesByCategory(props.Category)),\n        devicesByCategory: devicesByCategory,\n        propertiesFromDevices: propertiesFromDevices,\n        sendAlexaCommand: sendAlexaCommand,\n        devices: devicesByCategory(props.Category)\n      }));\n    });\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvb2xkL2RhdGFDb250ZXh0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL29sZC9kYXRhQ29udGV4dC5qcz9mZWJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIGNyZWF0ZUVsZW1lbnQgIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNyZWF0ZVNvY2tldCBmcm9tIFwic29ja2V0dGUtY29tcG9uZW50XCI7XG5jb25zdCBTb2NrZXR0ZSA9IGNyZWF0ZVNvY2tldCh7IENvbXBvbmVudCwgY3JlYXRlRWxlbWVudCB9KTtcblxuXG5leHBvcnQgY2xhc3MgRGF0YVByb3ZpZGVyIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBkZXZpY2VzOiBbXSxcbiAgICAgICAgICAgIGRldmljZVN0YXRlOiB7fSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJzOiB7fSxcbiAgICAgICAgICAgIHZpcnR1YWxEZXZpY2VzOiB7fSxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc2VydmVyOiBcIndzczovL1wiK3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZStcIi93c1wiLFxuICAgICAgICAgICAgc29ja2V0OiBudWxsLFxuICAgICAgICAgICAgd2Vic29ja2V0U3RhdHVzOiAnaW5pdCcsXG4gICAgICAgICAgICBjb2xvclNjaGVtZTogJycsXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB0aGlzLnBlbmRpbmdEZXZzPVtdO1xuICAgICAgICB0aGlzLmRldmljZUJ5TmFtZSA9IHRoaXMuZGV2aWNlQnlOYW1lLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZGV2aWNlc0J5Q2F0ZWdvcnkgPSB0aGlzLmRldmljZXNCeUNhdGVnb3J5LmJpbmQodGhpcyk7XG4gICAgfVxuICAgIFxuICAgIHV1aWR2NCAgPSAoKSAgPT4ge1xuICAgICAgICByZXR1cm4gKFsxZTddKy0xZTMrLTRlMystOGUzKy0xZTExKS5yZXBsYWNlKC9bMDE4XS9nLCBjID0+XG4gICAgICAgICAgICAoYyBeIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMSkpWzBdICYgMTUgPj4gYyAvIDQpLnRvU3RyaW5nKDE2KVxuICAgICAgICApXG4gICAgfVxuXG4gICAgb25PcGVuID0gZXYgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHt3ZWJzb2NrZXRTdGF0dXM6XCJjb25uZWN0ZWRcIn0pXG4gICAgICAgIGNvbnNvbGUubG9nKFwiV2Vic29ja2V0IGNvbm5lY3RlZC5cIik7XG4gICAgfVxuIFxuICAgIG9uTWVzc2FnZSA9IGV2ID0+IHtcbiAgICAgICAgdmFyIGpzb25kYXRhPUpTT04ucGFyc2UoZXYuZGF0YSlcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIj4gUmVjZWl2ZWQ6XCIsIGpzb25kYXRhKTtcbiAgICAgICAgaWYgKGpzb25kYXRhLmhhc093blByb3BlcnR5KCdldmVudCcpKSB7XG4gICAgICAgICAgICB2YXIgZGV2U3RhdGU9dGhpcy5zdGF0ZS5kZXZpY2VTdGF0ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGRldiBpbiB0aGlzLnN0YXRlLmRldmljZVN0YXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZGV2aWNlU3RhdGVbZGV2XS5ldmVudC5lbmRwb2ludC5lbmRwb2ludElkPT1qc29uZGF0YS5ldmVudC5lbmRwb2ludC5lbmRwb2ludElkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ01hdGNoJyxkZXYsdGhpcy5zdGF0ZS5kZXZpY2VTdGF0ZVtkZXZdLGpzb25kYXRhLmV2ZW50LmVuZHBvaW50LmVuZHBvaW50SWQpXG4gICAgICAgICAgICAgICAgICAgIGlmICgoanNvbmRhdGEuZXZlbnQuaGVhZGVyLm5hbWU9XCJDaGFuZ2VSZXBvcnRcIikgJiYganNvbmRhdGEucGF5bG9hZC5oYXNPd25Qcm9wZXJ0eSgnY2hhbmdlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3BheWxvYWQnLGpzb25kYXRhLnBheWxvYWQpXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGpzb25kYXRhLnBheWxvYWQuY2hhbmdlLnByb3BlcnRpZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uZGF0YS5jb250ZXh0LnByb3BlcnRpZXMucHVzaChqc29uZGF0YS5wYXlsb2FkLmNoYW5nZS5wcm9wZXJ0aWVzW2pdKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAganNvbmRhdGEucGF5bG9hZD17fVxuICAgICAgICAgICAgICAgICAgICAgICAganNvbmRhdGEuZXZlbnQuaGVhZGVyLm5hbWU9XCJTdGF0ZVJlcG9ydFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdQcm9wczonLGpzb25kYXRhLmNvbnRleHQucHJvcGVydGllcylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkZXZTdGF0ZVtkZXZdPWpzb25kYXRhXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgZGV2aWNlU3RhdGU6IGRldlN0YXRlIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmF3VXBkYXRlOiBKU09OLnBhcnNlKGV2LmRhdGEpfSlcbiAgICAgICAgfVxuICAgIH1cbiBcbiAgICBvblJlY29ubmVjdCA9IGV2ID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCI+IFJlY29ubmVjdGluZy4uLlwiLCBldik7XG4gICAgfVxuIFxuICAgIHNlbmRNZXNzYWdlID0gZXYgPT4ge1xuICAgICAgICAvLyBXZWJTb2NrZXQgYXZhaWxhYmxlIGluIHN0YXRlIVxuICAgICAgICBjb25zb2xlLmxvZygnU2VuZGluZycsIGV2KVxuICAgICAgICB0aGlzLnN0YXRlLnNvY2tldC5zZW5kKGV2KTtcbiAgICB9XG5cbiAgICBcbiAgICBzZW5kQWxleGFDb21tYW5kID0gKGRldmljZU5hbWUsIGVuZHBvaW50SWQsIGNvbnRyb2xsZXIsIGNvbW1hbmQsIHZhbCkgPT4ge1xuICAgICAgICBcbiAgICAgICAgLy8gdmFsdWUgaXMgb3B0aW9uYWwgZm9yIHNvbWUgYWxleGEgY29tbWFuZHMuICBUaGUgb3JpZ2luYWwgc29mYTIgaW1wbGVtZW50YXRpb24gdHJpZWQgdG8gdGFrZSBhIHN0cmluZyB2YWx1ZSBhbmQgdGhlbiBtYXAgaXQgdG8gXG4gICAgICAgIC8vIGEgdmFsdWUgbmFtZSwgYnV0IHVuZGVyZXN0aW1hdGVkIHRoZSByZXF1aXJlbWVudCBmb3Igc29tZSBjb21tYW5kcyB0byBwYXNzIG11bHRpcGxlIHZhbHVlcyBhbmQgbmVlZHMgdG8gYmUgYWRqdXN0ZWQuXG4gICAgICAgIFxuICAgICAgICBpZiAoZW5kcG9pbnRJZD09JycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBlbmRwb2ludCBJRCB3YXMgcHJvdmlkZWQgZm9yICcsIGRldmljZU5hbWUsIGNvbnRyb2xsZXIsIGNvbW1hbmQsIHZhbClcbiAgICAgICAgICAgIGVuZHBvaW50SWQ9dGhpcy5kZXZpY2VCeU5hbWUoZGV2aWNlTmFtZSkuZW5kcG9pbnRJZFxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGhlYWRlcj17XCJuYW1lXCI6IGNvbW1hbmQsIFwibmFtZXNwYWNlXCI6XCJBbGV4YS5cIiArIGNvbnRyb2xsZXIsIFwicGF5bG9hZFZlcnNpb25cIjpcIjNcIiwgXCJtZXNzYWdlSWRcIjogdGhpcy51dWlkdjQoKSwgXCJjb3JyZWxhdGlvblRva2VuXCI6IHRoaXMudXVpZHY0KCl9XG4gICAgICAgIHZhciBlbmRwb2ludD17XCJlbmRwb2ludElkXCI6IGVuZHBvaW50SWQsIFwiY29va2llXCI6IHt9LCBcInNjb3BlXCI6eyBcInR5cGVcIjpcIkJlYXJlclRva2VuXCIsIFwidG9rZW5cIjpcImFjY2Vzcy10b2tlbi1mcm9tLXNraWxsXCIgfX1cblxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmNvbnRyb2xsZXJzW2NvbnRyb2xsZXJdW2NvbW1hbmRdKSB7XG4gICAgICAgICAgICB2YXIgcGF5bG9hZD1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuc3RhdGUuY29udHJvbGxlcnNbY29udHJvbGxlcl1bY29tbWFuZF0pKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHBheWxvYWQ9e31cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gcGF5bG9hZCkge1xuICAgICAgICAgICAgaWYgKHBheWxvYWRbcHJvcF09PSd2YWx1ZScpIHtcbiAgICAgICAgICAgICAgICBwYXlsb2FkW3Byb3BdPXZhbFxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGE9e1wiZGlyZWN0aXZlXCI6IHtcImhlYWRlclwiOiBoZWFkZXIsIFwiZW5kcG9pbnRcIjogZW5kcG9pbnQsIFwicGF5bG9hZFwiOiBwYXlsb2FkIH19XG4gICAgICAgIGNvbnNvbGUubG9nKCdTZW5kaW5nIGFsZXhhIGNvbW1hbmQ6JyxkYXRhKVxuICAgICAgICAvL3RoaXMucG9zdEFsZXhhQ29tbWFuZChkYXRhKVxuICAgICAgICBmZXRjaCgnL2RpcmVjdGl2ZScsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJyxcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihyZXM9PmNvbnNvbGUubG9nKCdBbGV4YSBjb21tYW5kIHJlc3BvbnNlOicscmVzKSlcbiAgICB9XG4gICAgXG4gICAgbWVyZ2VTdGF0ZSA9IChkZXYsY2hhbmdlKSA9PiB7XG4gICAgICAgIFxuICAgICAgICBpZiAoZGV2IT09dW5kZWZpbmVkICYmIGNoYW5nZSE9PXVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRldnN0YXRlPXsuLi50aGlzLnN0YXRlLmRldmljZVN0YXRlfTtcbiAgICAgICAgICAgIGRldnN0YXRlW2Rldl09Y2hhbmdlXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtkZXZpY2VTdGF0ZTpkZXZzdGF0ZX0pXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IFxuICAgIH1cbiAgICBcbiAgICBtZXJnZVN0YXRlcyA9IChkZXZzKSA9PiB7XG4gICAgICAgIHZhciBkZXZzdGF0ZT0gey4uLnRoaXMuc3RhdGUuZGV2aWNlU3RhdGUsIC4uLmRldnMgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKHtkZXZpY2VTdGF0ZTpkZXZzdGF0ZX0sIFxuICAgICAgICAgICAgKCkgPT4gY29uc29sZS5sb2coJ01lcmdlIHN0YXRlIGRvbmUnLCBPYmplY3Qua2V5cyhkZXZzKS5sZW5ndGgpXG4gICAgICAgIClcbiAgICB9XG4gICAgXG4gICAgdXBkYXRlRGV2aWNlID0gZGV2ID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnBlbmRpbmdEZXZzLmluY2x1ZGVzKGRldikpIHtcbiAgICAgICAgICAgIC8vdmFyIHByZXN0YXRlPXsuLi50aGlzLnN0YXRlLmRldmljZVN0YXRlfVxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndXBkYXRlIHByZXN0YXRlJyxkZXYscHJlc3RhdGUpXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdEZXZzLnB1c2goZGV2KVxuICAgICAgICAgICAgLy9wcmVzdGF0ZVtkZXZdPXt9XG4gICAgICAgICAgICAvL3RoaXMuc2V0U3RhdGUoe2RldmljZVN0YXRlOnByZXN0YXRlfSlcbiAgICAgICAgICAgIGZldGNoKCcvZGF0YS9kZXZpY2VzLycrZGV2Kyc/c3RhdGVSZXBvcnQnKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdD0+cmVzdWx0Lmpzb24oKSlcbiAgICAgICAgICAgICAgICAudGhlbihkYXRhPT50aGlzLm1lcmdlU3RhdGUoZGV2LGRhdGEpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdXBkYXRlTXVsdGlwbGVEZXZpY2VzID0gKGRldnMpID0+IHtcblxuICAgICAgICBjb25zb2xlLmxvZygnZ2V0dGluZyB1cGRhdGVzIGZvciBtdWx0aXBsZSBkZXZpY2VzJywgZGV2cy5sZW5ndGgpXG4gICAgICAgIGZldGNoKCcvZGV2aWNlU3RhdGUnLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRldnMpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzPT5yZXMuanNvbigpKVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+dGhpcy5tZXJnZVN0YXRlcyhyZXMpKSAgICBcbiAgICB9XG5cbiAgICB1cGRhdGVEZXZpY2VMaXN0ID0gKGRldnMpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3VwZGF0aW5nIGRldmljZXMnLCBkZXZzKVxuICAgICAgICB2YXIgdWRsPVtdXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGV2cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdWRsLnB1c2goZGV2c1tpXS5mcmllbmRseU5hbWUpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7ZGV2aWNlczogZGV2c30sIFxuICAgICAgICAgICAgKCkgPT4gIHRoaXMudXBkYXRlTXVsdGlwbGVEZXZpY2VzKHVkbClcbiAgICAgICAgKVxuICAgIH1cbiAgICBcbiAgICBkZXZpY2VzQnlDYXRlZ29yeSA9IGNhdGVnb3J5ID0+IHtcbiAgICAgICAgXG4gICAgICAgIGlmICghY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5PSdBTEwnXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhdGVnb3J5RGV2aWNlcz1bXVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc3RhdGUuZGV2aWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZGV2aWNlc1tpXS5kaXNwbGF5Q2F0ZWdvcmllcy5pbmNsdWRlcyhjYXRlZ29yeSkgfHwgY2F0ZWdvcnk9PSdBTEwnKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlEZXZpY2VzLnB1c2godGhpcy5zdGF0ZS5kZXZpY2VzW2ldKVxuICAgICAgICAgICAgfSBcbiAgICAgICAgfVxuICAgICAgICBjYXRlZ29yeURldmljZXMuc29ydChmdW5jdGlvbihhLCBiKSAge1xuXHRcdCAgICB2YXIgeD1hWydmcmllbmRseU5hbWUnXS50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0eT1iWydmcmllbmRseU5hbWUnXS50b0xvd2VyQ2FzZSgpO1xuXHRcdCAgICByZXR1cm4geDx5ID8gLTEgOiB4PnkgPyAxIDogMDtcblx0ICAgIH0pOyAgICBcblx0ICAgIGNvbnNvbGUubG9nKCdjYXQgZGV2cyBmb3InLCBjYXRlZ29yeSwgY2F0ZWdvcnlEZXZpY2VzKVxuICAgICAgICByZXR1cm4gY2F0ZWdvcnlEZXZpY2VzXG4gICAgICAgIFxuICAgIH1cblxuICAgIGRldmljZUJ5TmFtZSA9IGRldm5hbWUgPT4ge1xuICAgICAgICB2YXIgZm49W11cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN0YXRlLmRldmljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmRldmljZXNbaV1bJ2ZyaWVuZGx5TmFtZSddPT1kZXZuYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuZGV2aWNlc1tpXVxuICAgICAgICAgICAgfSBcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBkZXZpY2VCeUVuZHBvaW50SWQgPSBlbmRwb2ludElkID0+IHtcbiAgICAgICAgdmFyIGZuPVtdXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zdGF0ZS5kZXZpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5kZXZpY2VzW2ldWydlbmRwb2ludElkJ109PWVuZHBvaW50SWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZS5kZXZpY2VzW2ldXG4gICAgICAgICAgICB9IFxuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCdEaWQgbm90IGZpbmQgZGV2aWNlIG5hbWVkJywgZW5kcG9pbnRJZCwgdGhpcy5zdGF0ZS5kZXZpY2VzLmxlbmd0aClcbiAgICB9XG5cbiAgICBwcm9wZXJ0aWVzRnJvbURldmljZXMgPSBkZXZzID0+IHtcblxuICAgICAgICB2YXIgZGV2c3RhdGU9e31cbiAgICAgICAgdmFyIG5vc3RhdGU9W11cbiAgICAgICAgaWYgKGRldnM9PW51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBkZXZzdGF0ZVxuICAgICAgICB9IFxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGV2cykpIHtcbiAgICAgICAgICAgIGRldnM9W2RldnNdXG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZXZzLmxlbmd0aDsgaSsrKSB7ICAgXG4gICAgICAgICAgICBkZXZzdGF0ZVtkZXZzW2ldLmZyaWVuZGx5TmFtZV09e31cbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmRldmljZVN0YXRlLmhhc093blByb3BlcnR5KGRldnNbaV0uZnJpZW5kbHlOYW1lKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmRldmljZVN0YXRlW2RldnNbaV0uZnJpZW5kbHlOYW1lXS5oYXNPd25Qcm9wZXJ0eSgnY29udGV4dCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5zdGF0ZS5kZXZpY2VTdGF0ZVtkZXZzW2ldLmZyaWVuZGx5TmFtZV0uY29udGV4dC5wcm9wZXJ0aWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXZzdGF0ZVtkZXZzW2ldLmZyaWVuZGx5TmFtZV1bdGhpcy5zdGF0ZS5kZXZpY2VTdGF0ZVtkZXZzW2ldLmZyaWVuZGx5TmFtZV0uY29udGV4dC5wcm9wZXJ0aWVzW2pdLm5hbWVdPXRoaXMuc3RhdGUuZGV2aWNlU3RhdGVbZGV2c1tpXS5mcmllbmRseU5hbWVdLmNvbnRleHQucHJvcGVydGllc1tqXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucGVuZGluZ0RldnMuaW5jbHVkZXMoZGV2c1tpXS5mcmllbmRseU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nRGV2cy5wdXNoKGRldnNbaV0uZnJpZW5kbHlOYW1lKVxuICAgICAgICAgICAgICAgIG5vc3RhdGUucHVzaChkZXZzW2ldLmZyaWVuZGx5TmFtZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKG5vc3RhdGUubGVuZ3RoPjApIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTXVsdGlwbGVEZXZpY2VzKG5vc3RhdGUpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGV2c3RhdGVcbiAgICAgICAgXG4gICAgfVxuXG4gICAgc2V0Q29sb3JTY2hlbWUgPSBzY2hlbWUgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnc2V0IGNvbG9yIHNjaGVtZScsIHNjaGVtZSlcbiAgICAgICAgY29uc29sZS5sb2coJ3RoaXMnLHRoaXMpXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbG9yU2NoZW1lOiBzY2hlbWV9KVxuICAgIH1cbiAgICBcbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlV2luZG93U2l6ZUNoYW5nZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaGluZyBkZXZpY2UgaW5mbycpXG4gICAgICAgIGZldGNoKCcvZGV2aWNlTGlzdCcpXG4gXHRcdCAgICAudGhlbihyZXN1bHQ9PnJlc3VsdC5qc29uKCkpXG4gICAgICAgICAgICAudGhlbihkYXRhPT50aGlzLnVwZGF0ZURldmljZUxpc3QoZGF0YSkpXG4gICAgICAgICAgICAvLy50aGVuKHRoaXMuc2V0U3RhdGUoe2RldmljZXM6IGRhdGF9KVxuICAgICAgICAgICAgXG4gIFx0ICAgIGZldGNoKCcvY29udHJvbGxlcmNvbW1hbmRzJylcbiBcdFx0ICAgIC50aGVuKHJlc3VsdD0+cmVzdWx0Lmpzb24oKSlcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdD0+dGhpcy5zZXRTdGF0ZSh7Y29udHJvbGxlcnM6cmVzdWx0fSkpO1xuXG4gIFx0ICAgIGZldGNoKCcvbGlzdC9sb2dpYy92aXJ0dWFsRGV2aWNlcycpXG4gXHRcdCAgICAudGhlbihyZXN1bHQ9PnJlc3VsdC5qc29uKCkpXG4gICAgICAgICAgICAudGhlbihyZXN1bHQ9PnRoaXMuc2V0U3RhdGUoeyB2aXJ0dWFsRGV2aWNlczpyZXN1bHQgfSkpXG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7IGNoaWxkcmVuIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8RGF0YUNvbnRleHQuUHJvdmlkZXJcbiAgICAgICAgICAgICAgICB2YWx1ZT17e1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlczogdGhpcy5zdGF0ZS5kZXZpY2VzLFxuICAgICAgICAgICAgICAgICAgICBkZXZpY2VTdGF0ZTogdGhpcy5zdGF0ZS5kZXZpY2VTdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgdmlydHVhbERldmljZXM6IHRoaXMuc3RhdGUudmlydHVhbERldmljZXMsXG4gICAgICAgICAgICAgICAgICAgIHdlYnNvY2tldFN0YXR1czogdGhpcy5zdGF0ZS53ZWJzb2NrZXRTdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJzOnRoaXMuc3RhdGUuY29udHJvbGxlcnMsXG4gICAgICAgICAgICAgICAgICAgIHNlbmRBbGV4YUNvbW1hbmQ6IHRoaXMuc2VuZEFsZXhhQ29tbWFuZCxcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlQnlOYW1lOiB0aGlzLmRldmljZUJ5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlc0J5Q2F0ZWdvcnk6IHRoaXMuZGV2aWNlc0J5Q2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNGcm9tRGV2aWNlczogdGhpcy5wcm9wZXJ0aWVzRnJvbURldmljZXMsXG4gICAgICAgICAgICAgICAgICAgIGRldmljZUJ5RW5kcG9pbnRJZDogdGhpcy5kZXZpY2VCeUVuZHBvaW50SWQsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yU2NoZW1lOiB0aGlzLnN0YXRlLmNvbG9yU2NoZW1lLFxuICAgICAgICAgICAgICAgICAgICBzZXRDb2xvclNjaGVtZTogdGhpcy5zZXRDb2xvclNjaGVtZSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICAgICAgICA8U29ja2V0dGUgXG4gICAgICAgICAgICAgICAgICAgIHVybD17dGhpcy5zdGF0ZS5zZXJ2ZXJ9XG4gICAgICAgICAgICAgICAgICAgIGdldFNvY2tldD17c29ja2V0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3NvY2tldH0pO1xuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBtYXhBdHRlbXB0cz17MjV9XG4gICAgICAgICAgICAgICAgICAgIG9ub3Blbj17dGhpcy5vbk9wZW59XG4gICAgICAgICAgICAgICAgICAgIG9ubWVzc2FnZT17dGhpcy5vbk1lc3NhZ2V9XG4gICAgICAgICAgICAgICAgICAgIG9ucmVjb25uZWN0PXt0aGlzLm9uUmVjb25uZWN0fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0RhdGFDb250ZXh0LlByb3ZpZGVyPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IERhdGFDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dChEYXRhUHJvdmlkZXIpO1xuXG5leHBvcnQgZnVuY3Rpb24gd2l0aFNvZmFUaGVtZShDb21wb25lbnQpIHtcblxuICAgIHJldHVybiBmdW5jdGlvbiBEYXRhQ29tcG9uZW50KHByb3BzKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8RGF0YUNvbnRleHQuQ29uc3VtZXI+XG4gICAgICAgICAgICAgICAgeyAoe2NvbG9yU2NoZW1lfSkgPT4gXG4gICAgICAgICAgICAgICAgICAgIDxDb21wb25lbnQgey4uLnByb3BzfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9IC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9EYXRhQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhbHdpdGhUaGVtZUNoYW5nZShDb21wb25lbnQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gRGF0YUNvbXBvbmVudChwcm9wcykge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPERhdGFDb250ZXh0LkNvbnN1bWVyPlxuICAgICAgICAgICAgICAgIHsgKHsgc2V0Q29sb3JTY2hlbWUsIGNvbG9yU2NoZW1lfSkgPT4gXG4gICAgICAgICAgICAgICAgICAgIDxDb21wb25lbnQgey4uLnByb3BzfSBzZXRDb2xvclNjaGVtZT17c2V0Q29sb3JTY2hlbWV9IGNvbG9yU2NoZW1lPXtjb2xvclNjaGVtZX0gLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L0RhdGFDb250ZXh0LkNvbnN1bWVyPlxuICAgICAgICApO1xuICAgIH07XG4gICAgXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGhlbWVDaGFuZ2UoQ29tcG9uZW50KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIERhdGFDb21wb25lbnQocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxEYXRhQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgICAgICAgICB7IChjb250ZXh0KSA9PiBcbiAgICAgICAgICAgICAgICAgICAgPENvbXBvbmVudCB7Li4ucHJvcHN9IGNvbnRleHQ9e2NvbnRleHR9IHNldENvbG9yU2NoZW1lPXtjb250ZXh0LnNldENvbG9yU2NoZW1lfSBjb2xvclNjaGVtZT17Y29udGV4dC5jb2xvclNjaGVtZX0gLz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L0RhdGFDb250ZXh0LkNvbnN1bWVyPlxuICAgICAgICApO1xuICAgIH07XG4gICAgXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhEYXRhKENvbXBvbmVudCkge1xuICAgIHJldHVybiBmdW5jdGlvbiBEYXRhQ29tcG9uZW50KHByb3BzKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8RGF0YUNvbnRleHQuQ29uc3VtZXI+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICh7Y29udHJvbGxlcnMsIHZpcnR1YWxEZXZpY2VzLCBkZXZpY2VCeUVuZHBvaW50SWQsIGRldmljZXMsIGRldmljZVN0YXRlLCB3ZWJzb2NrZXRTdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGRldmljZUJ5TmFtZSwgZGV2aWNlc0J5Q2F0ZWdvcnksIHByb3BlcnRpZXNGcm9tRGV2aWNlcywgc2VuZEFsZXhhQ29tbWFuZH0pID0+IFxuICAgICAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi5wcm9wc30gY2F0PXt3ZWJzb2NrZXRTdGF0dXN9IGRldmljZUJ5RW5kcG9pbnRJZD17ZGV2aWNlQnlFbmRwb2ludElkfSBjb250cm9sbGVycz17Y29udHJvbGxlcnN9IHZpcnR1YWxEZXZpY2VzPXt2aXJ0dWFsRGV2aWNlc30gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZUJ5TmFtZT17ZGV2aWNlQnlOYW1lfSBkZXZpY2VQcm9wZXJ0aWVzPXtwcm9wZXJ0aWVzRnJvbURldmljZXMoZGV2aWNlc0J5Q2F0ZWdvcnkocHJvcHMuQ2F0ZWdvcnkpKX0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZXNCeUNhdGVnb3J5PXtkZXZpY2VzQnlDYXRlZ29yeX0gcHJvcGVydGllc0Zyb21EZXZpY2VzPXtwcm9wZXJ0aWVzRnJvbURldmljZXN9IHNlbmRBbGV4YUNvbW1hbmQ9e3NlbmRBbGV4YUNvbW1hbmR9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VzPXtkZXZpY2VzQnlDYXRlZ29yeShwcm9wcy5DYXRlZ29yeSl9IC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9EYXRhQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgKTtcbiAgICB9O1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBRkE7QUFxQkE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQXpCQTtBQTJCQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQTlCQTtBQWdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBekRBO0FBMkRBO0FBQ0E7QUFDQTtBQTdEQTtBQStEQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFuRUE7QUF1RUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFOQTtBQVFBO0FBQUE7QUFDQTtBQUNBO0FBNUdBO0FBK0dBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBdEhBO0FBd0hBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQTdIQTtBQStIQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUExSUE7QUE2SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQU5BO0FBUUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBekpBO0FBMkpBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFwS0E7QUF1S0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBekxBO0FBMkxBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWxNQTtBQW9NQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBNU1BO0FBK01BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBNU9BO0FBOE9BO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUEvT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFZQTtBQUNBO0FBQ0E7QUFqQkE7QUFrQkE7QUFDQTtBQXJCQTtBQUFBO0FBQUE7QUFxUEE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFwUUE7QUFBQTtBQUFBO0FBc1FBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBREE7QUFtQkE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVlBO0FBeFNBO0FBQ0E7QUFEQTtBQUFBO0FBMlNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFEQTtBQUtBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFEQTtBQUtBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFLQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFGQTtBQVNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/old/dataContext.js\n");

/***/ })

}]);